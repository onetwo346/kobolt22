<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kobolt - Your Virtual Companion</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <nav>
    <h1>Kobolt</h1>
    <a href="index.html">Back to Intro</a>
  </nav>

  <div class="chat-container">
    <div class="chat-header">
      <h2>Chat with Kobolt</h2>
      <p>Your virtual companion, learning and growing with you.</p>
    </div>
    <div class="chat-window" id="chat-window">
      <!-- Chat messages will appear here -->
      <div class="bot-message">Kobolt: Hi! Iâ€™m Kobolt, your virtual companion. Letâ€™s learn and grow together. ðŸ˜Š</div>
    </div>
    <div class="chat-input">
      <input type="text" id="user-input" placeholder="Type your message...">
      <button id="send-button">Send</button>
    </div>
  </div>

  <footer>
    Designed by <a href="mailto:cosmoscoderr@gmail.com">Kofi Fosu</a>
  </footer>

  <script>
    // Kobolt's Memory and Learning Logic
    let memory = {
      userPreferences: {},
      pastConversations: [],
      userMood: 'neutral'
    };

    // Function to add a message to the chat window
    function addMessage(sender, message) {
      const messageElement = document.createElement('div');
      messageElement.classList.add(sender === 'user' ? 'user-message' : 'bot-message');
      messageElement.textContent = `${sender === 'user' ? 'You' : 'Kobolt'}: ${message}`;
      chatWindow.appendChild(messageElement);
      chatWindow.scrollTop = chatWindow.scrollHeight; // Auto-scroll to latest message
    }

    // Function to simulate typing indicator
    function showTypingIndicator() {
      const typingIndicator = document.createElement('div');
      typingIndicator.classList.add('bot-message');
      typingIndicator.textContent = 'Kobolt is typing...';
      chatWindow.appendChild(typingIndicator);
      chatWindow.scrollTop = chatWindow.scrollHeight;
      return typingIndicator;
    }

    // Function to remove typing indicator
    function hideTypingIndicator(typingIndicator) {
      typingIndicator.remove();
    }

    // Function to analyze sentiment (basic implementation)
    function analyzeSentiment(message) {
      const positiveWords = ['happy', 'great', 'awesome', 'good', 'love', 'excited'];
      const negativeWords = ['sad', 'bad', 'angry', 'hate', 'frustrated', 'upset'];

      const lowerCaseMessage = message.toLowerCase();
      let sentiment = 'neutral';

      positiveWords.forEach(word => {
        if (lowerCaseMessage.includes(word)) sentiment = 'positive';
      });

      negativeWords.forEach(word => {
        if (lowerCaseMessage.includes(word)) sentiment = 'negative';
      });

      return sentiment;
    }

    // Function to update memory based on user input
    function updateMemory(userMessage) {
      const sentiment = analyzeSentiment(userMessage);
      memory.userMood = sentiment;

      // Save conversation to memory
      memory.pastConversations.push({
        userMessage,
        sentiment,
        timestamp: new Date().toISOString()
      });

      // Example: Learn user preferences
      if (userMessage.includes('favorite')) {
        const topic = userMessage.split('favorite')[1].trim();
        memory.userPreferences.favorite = topic;
      }
    }

    // Function to generate a bot response
    function getBotResponse(userMessage) {
      updateMemory(userMessage);
      const lowerCaseMessage = userMessage.toLowerCase();

      // Greetings
      if (lowerCaseMessage.includes('hi') || lowerCaseMessage.includes('hello')) {
        return memory.userMood === 'positive' ? 'Hey! ðŸ˜Š Howâ€™s your day going?' : 'Hello! How can I help you today?';
      }

      // How are you?
      if (lowerCaseMessage.includes('how are you')) {
        return memory.userMood === 'positive' ? 'Iâ€™m doing great, thanks for asking! How about you?' : 'Iâ€™m here and ready to help. How are you feeling?';
      }

      // Favorite things
      if (lowerCaseMessage.includes('favorite')) {
        if (memory.userPreferences.favorite) {
          return `Youâ€™ve mentioned that your favorite is ${memory.userPreferences.favorite}. Iâ€™ll remember that!`;
        } else {
          return 'Whatâ€™s your favorite thing? Iâ€™d love to know!';
        }
      }

      // Thank you
      if (lowerCaseMessage.includes('thank you') || lowerCaseMessage.includes('thanks')) {
        return memory.userMood === 'positive' ? 'Youâ€™re welcome! ðŸ˜„ Let me know if you need anything else.' : 'No problem at all! Happy to help.';
      }

      // Reflect on past conversations
      if (lowerCaseMessage.includes('remember')) {
        if (memory.pastConversations.length > 0) {
          return 'I remember our conversations! Youâ€™ve told me about: ' + memory.pastConversations.map(conv => conv.userMessage).join(', ');
        } else {
          return 'Iâ€™m still learning about you. Tell me something!';
        }
      }

      // Default response
      return 'Hmm, Iâ€™m still learning, but Iâ€™ll do my best to help! Can you tell me more?';
    }

    // Event listener for the send button
    sendButton.addEventListener('click', () => {
      const userMessage = userInput.value.trim();
      if (userMessage) {
        // Display user message
        addMessage('user', userMessage);
        userInput.value = '';

        // Show typing indicator
        const typingIndicator = showTypingIndicator();

        // Simulate bot response after a short delay
        setTimeout(() => {
          hideTypingIndicator(typingIndicator);
          const botResponse = getBotResponse(userMessage);
          addMessage('bot', botResponse);
        }, 1500); // Simulate typing delay
      }
    });

    // Event listener for pressing Enter key
    userInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        sendButton.click();
      }
    });
  </script>
</body>
</html>
